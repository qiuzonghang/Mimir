{"name": "讲义制作-获取纸张克重定义", "status": "failed", "statusDetails": {"message": "AssertionError", "trace": "self = <Mimir.qz_auto_test.ApiTestCase.test_JYZZ_ApiTest.TestCase object at 0x000001E861ABB070>\nget_JYZZ_param = {'data': {'add_paper_data': {'id': 0, 'name': '', 'type': 'PapaerWeight', 'value': 329}, 'add_paper_url': '/api/GSMJYZ...ash': '6C397A6F5CC25501', 'hrCname': '王野', ...}, 'message': '请求(或处理)成功', 'statusCode': 200, 'timestamp': '1659669942'}}\nget_dev_sql_server = <pymssql._pymssql.Cursor object at 0x000001E861AB5D80>\n\n    @allure.title('讲义制作-获取纸张克重定义')\n    @allure.feature('JYZZ_query_paper_weight')\n    @allure.severity('critical')\n    @allure.story('JYZZ_query_paper_weight')\n    @allure.step(\"JYZZ_query_paper_weight\")\n    def test_query_paper_weight(self, get_JYZZ_param, get_dev_sql_server):\n        # pytest.xfail('排序错误，已知问题')\n        uri = get_JYZZ_param.get('url') + get_JYZZ_param.get('data').get('add_paper_url')\n        data = get_JYZZ_param.get('data').get('query_paper_data')\n        data['type'] = 'PapaerWeight'\n        header = {'authorization': get_JYZZ_param['token'], 'content-type': 'application/json'}\n        data_list = []\n        [data_list.append(k + '=' + str(v)) for k, v in data.items()]\n        url = uri + '?' + '&'.join(data_list)\n        response = request.get_request(url=url, header=header)\n        log.info('Response:' + str(response))\n        sql_server = get_dev_sql_server\n        sql = \"select * from GSM_JYZZ_Dic where Type = 'PapaerWeight' order by DId \"\n        sql_server.execute(sql)\n        sql_result = sql_server.fetchall()\n        log.info('Sql_result:' + str(sql_result))\n        query_paper = response.get('body').get('data').get('data')\n        # assert_dict['query_paper_weight'] = random.choice(query_paper)\n        with allure.step('校验结果'):\n            allure.attach(str(response) + '\\n' + str(sql_result), '实际结果')\n            allure.attach('1、正确返回数据\\n2、数据库查验', '预期结果')\n        test.assert_code(response.get('body').get('statusCode'), 200)\n        for query_num in range(len(query_paper)):\n>           test.assert_in_text(str(sql_result[query_num][0]), str(query_paper[query_num]['dId']))\n\nApiTestCase\\test_JYZZ_ApiTest.py:213: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <Mimir.qz_auto_test.Common.Assert.Assertions object at 0x000001E861A8A680>\nbody = '71', expected_msg = '137'\n\n    def assert_in_text(self, body, expected_msg):\n        \"\"\"\n        验证response body中是否包含预期字符串\n        :param body:\n        :param expected_msg:\n        :return:\n        \"\"\"\n        try:\n            text = json.dumps(body, ensure_ascii=False)\n            # print(text)\n>           assert expected_msg in body\nE           AssertionError\n\nCommon\\Assert.py:71: AssertionError"}, "steps": [{"name": "JYZZ_query_paper_weight", "status": "failed", "statusDetails": {"message": "AssertionError\n", "trace": "  File \"C:\\Users\\86199\\PycharmProjects\\pythonProject\\venv\\lib\\site-packages\\allure_commons\\_allure.py\", line 172, in impl\n    return func(*a, **kw)\n  File \"C:\\Users\\86199\\PycharmProjects\\pythonProject\\Mimir\\qz_auto_test\\ApiTestCase\\test_JYZZ_ApiTest.py\", line 213, in test_query_paper_weight\n    test.assert_in_text(str(sql_result[query_num][0]), str(query_paper[query_num]['dId']))\n  File \"C:\\Users\\86199\\PycharmProjects\\pythonProject\\Mimir\\qz_auto_test\\Common\\Assert.py\", line 71, in assert_in_text\n    assert expected_msg in body\n"}, "steps": [{"name": "校验结果", "status": "passed", "attachments": [{"name": "实际结果", "source": "dbe5aead-852c-4220-ad22-5825dbeb0dab-attachment.attach"}, {"name": "预期结果", "source": "7f3c583b-0e6e-4f95-80dd-47c9abd56154-attachment.attach"}], "start": 1659669955569, "stop": 1659669955575}], "parameters": [{"name": "get_JYZZ_param", "value": "{'url': 'devsite.qintelligence.cn', 'data': {'apply_url': '/api/GSMJYZZApply/Apply', 'apply_data': {'applyCount': 50, 'applyNo': '', 'className': '测试项目管理课程1', 'classTeacher': ' 张圣平 ', 'departmentId': '5', 'departmentName': 'ExEd中心', 'endClassDate': '2022-08-05', 'id': 0, 'sourceOfFunds': '自动化测试切勿操作', 'startClassDate': '2022-08-05', 'startClassId': 36, 'startClassMoudle': '自动化测试切勿操作', 'startClassName': '测试101'}, 'start_class_url': '/api/GSMJYZZApply/GetGSMStartClass?', 'start_class_data': {'Name': ''}, 'school_roll_class_url': '/api/GSMJYZZApply/GetGSMSchoolRollClass?', 'school_roll_class_data': {'Name': ''}, 'get_list_url': '/api/GSMJYZZApply/GetList', 'get_list_data': {'pageNo': 0, 'orderBy': 'creationTime', 'sort': 'desc', 'queryText': '', 'conModels': [{'fieldName': 'currentActive', 'fieldValue': '1,2,3', 'conditionalType': 6}], 'pageSize': 10}, 'add_paper_url': '/api/GSMJYZZDic', 'add_paper_data': {'id': 0, 'type': 'PapaerWeight', 'name': '', 'value': 329}, 'query_paper_data': {'pageNo': 0, 'type': '', 'pageSize': 100}}, 'token': 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.eyJhdWQiOiIxZmViZWJjMy0yNjJlLTQ1YzgtOTVjNi1iMzdjMzllZGE0YjYiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vMTVlMzRmOWUtMTFiNy00ZWI4LTkwNzgtYTY5NzJmOWM1MjkyL3YyLjAiLCJpYXQiOjE2NTk2NjUwMzgsIm5iZiI6MTY1OTY2NTAzOCwiZXhwIjoxNjU5NjcwMjI4LCJhaW8iOiJBU1FBMi84VEFBQUFMaFdEK01SZzl2bUhXekFuNjk3OFc0T1dKNmpRVzhiNDBuUnlqcEhvZ29RPSIsImF6cCI6IjU5ZWU4M2Y2LTZmMjUtNGFmYi1iMjdkLWMyMDUyM2UzNjQyMSIsImF6cGFjciI6IjAiLCJlbWFpbCI6Indhbmd5ZUBxeW5ldC5vbm1pY3Jvc29mdC5jb20iLCJmYW1pbHlfbmFtZSI6IueOiyIsImdpdmVuX25hbWUiOiLph44iLCJncm91cHMiOlsiZTc0ZDFkZmYtMDk3OC00NDY1LTk0MTgtMjU3ZDVhN2FkNzhkIl0sImlwYWRkciI6IjEyMy4xMTMuMTA1LjEyNSIsIm5hbWUiOiLnjovph44iLCJvaWQiOiJjNWNkNDMyMi01ZTAzLTRmOWQtODg1OS02NzUyZTg5OWI2ODYiLCJwbGF0ZiI6IjMiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ3YW5neWVAcXluZXQub25taWNyb3NvZnQuY29tIiwicmgiOiIwLkFWWUFua19qRmJjUnVFNlFlS2FYTDV4U2tzUHI2eDh1SnNoRmxjYXpmRG50cExaV0FPVS4iLCJzY3AiOiJhY2Nlc3NfYXNfdXNlciIsInNpZCI6Ijc3NjBkMmI0LWM5NzQtNDU1Mi04ZjI4LTVkNDZhMDJlZGU2YyIsInN1YiI6IlVzWGs0SzdsSUp1eHR2S2x4LU4xekNfR0dLZ21MZGVKSjlsN0V4YWNFa28iLCJ0ZW5hbnRfcmVnaW9uX3Njb3BlIjoiQVMiLCJ0aWQiOiIxNWUzNGY5ZS0xMWI3LTRlYjgtOTA3OC1hNjk3MmY5YzUyOTIiLCJ1cG4iOiJ3YW5neWVAcXluZXQub25taWNyb3NvZnQuY29tIiwidXRpIjoielFrYS1KbEVDRVNna2dPcWZ6MFBBQSIsInZlciI6IjIuMCIsInZlcmlmaWVkX3ByaW1hcnlfZW1haWwiOlsid2FuZ3llQHF5bmV0Lm9ubWljcm9zb2Z0LmNvbSJdLCJ3aWRzIjpbImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdfQ.vpLKuU3FdfbUVuoAVv1fVAhy6EiIVUFxHJacYS3lql6kQy5O3i1LaGMR6aND8A2tAvEhBCJJDh0OrarLGK2_VRrk23peYMPhCwcpzOmpLGLqzW6QUmOIx_wVG-aQbnDvia_3fRtF4yN-jbiVbRDt3xfEDFDeVfB3wH9x7DSGhEpbibTgnVfH5D1JBoLdnjdGRfb1iwLtr_mXl-VjgCxCeh-upRWMbhjJxyKfuQHvLqZOWNSO792FUh-KyKOHM7x8qtbBtlstd8Q69ojJG_gcnQRbruxRzK9XWV1C6LaFlJxSEkwD-Qh84HzpQFPDn8A3OuuArfBDvdwXUx4oyYxqPw', 'user_info': {'data': {'userID': 'c5cd4322-5e03-4f9d-8859-6752e899b686', 'name': '王野', 'username': 'wangye', 'email': 'wangye@qynet.onmicrosoft.com', 'isAuthenticated': True, 'isAdmin': True, 'isSuperAdmin': False, 'roleId': None, 'roles': [{'id': '0595A7A7-D758-44B9-80BE-B666D5D24AE2', 'name': 'alumni.emba.admin', 'remark': '【EMBA校友】的管理员权限'}, {'id': '1227A87F-4623-49DC-A0D9-196034A83705', 'name': 'enroll.emba.shenzhen.admin', 'remark': '【EMBA招生】深圳班管理员权限'}, {'id': '1594A6F9-AE80-4D9B-9ABD-42E60A087E95', 'name': 'enroll.exed.adminproject.dz', 'remark': '【Exed定制课】项目管理权限'}, {'id': '1937233E-2A8E-4166-8AB5-E7FBF617E7CF', 'name': 'enroll.emba.shanghai.admin', 'remark': '【EMBA招生】上海班管理员权限'}, {'id': '40AF1217-3B90-42A1-8006-886A68AFC990', 'name': 'Faculty', 'remark': '【职员】全部职员'}, {'id': '4E32A13A-B6FB-4FE4-AB1A-9E13FAF776E0', 'name': 'alumni.mba.admin', 'remark': '【MBA校友】的管理员权限'}, {'id': '52F46ACB-4117-47EB-9348-14DAA5BA8157', 'name': 'site.admin', 'remark': '【站点管理员】'}, {'id': '58752B16-3652-4C57-85B5-3E6A46B3F39B', 'name': 'alumni.find.user', 'remark': '【校友中心】的普通查询权限'}, {'id': '58FBF28C-EDC8-4DD7-AD27-8943B3AFDDAF', 'name': 'hr.human.admin', 'remark': '【人力管理员】权限'}, {'id': '5F307DD6-3EA9-43DF-BEF9-045646DB9047', 'name': 'Administration.Admin', 'remark': '【行政】管理员权限'}, {'id': '6470F726-DC5E-44CC-A122-34E9D7A78FAC', 'name': 'alumni.find.poweruser', 'remark': '【校友中心】的高级查询权限'}, {'id': '65A77BD7-4614-4DB7-8174-2E2CC3879E22', 'name': 'Catering.admin', 'remark': '【餐饮】管理员权限'}, {'id': '6C905592-AA28-4EEB-BD63-6D752B5BD2C9', 'name': 'alumni.undergraduate.admin', 'remark': '【本科校友】的管理员权限'}, {'id': '7FB843C2-00CB-4E31-9967-53D77795917C', 'name': 'alumni.admin', 'remark': '【校友中心】的管理员权限'}, {'id': '803C5C27-7490-4D06-BCF0-85E38D791CE5', 'name': 'resource.reservation.admin', 'remark': '【资源预定】的管理权限'}, {'id': '81A73355-990D-47D3-9BDB-DDECECE5D469', 'name': 'it.admin', 'remark': '[it]管理员权限'}, {'id': '81CC074D-2ECE-4A2C-A001-ADAE821E8833', 'name': 'enroll.emba.beijing.spring.admin', 'remark': '【EMBA招生】春季北京班管理员权限'}, {'id': '91586705-127C-484C-B1C5-89DD0144710A', 'name': 'enroll.mba.mainland.admin', 'remark': '【MBA大陆招生】的管理员权限'}, {'id': '94D11345-B00E-4FEA-8AD7-6C2F4F6AB02C', 'name': 'enroll.mba.xplan.admin', 'remark': '【MBAX计划招生】的管理员权限'}, {'id': '97B89429-906C-47FD-865B-866B8C1E1153', 'name': 'enroll.emba.beijing.autumn.admin', 'remark': '【EMBA招生】秋季北京班管理员权限'}, {'id': '9998C8ED-B77E-43B2-A7D1-23F84EC38DAA', 'name': 'hr.performance.admin', 'remark': '【绩效管理系统】管理员权限'}, {'id': '9AF8B91E-424F-4FF4-9166-1731F109326A', 'name': 'Faculty&Staff', 'remark': '【教职员】所有用户'}, {'id': 'D4082872-B51B-4139-978C-CAFB97C7604C', 'name': 'alumni.find.superuser', 'remark': '【校友中心】的管理权限'}, {'id': 'D88F4F60-E572-48D5-8FE2-4D646E0B1EE5', 'name': 'enroll.emba.mainland.admin', 'remark': '【EMBA招生】的管理员权限'}, {'id': 'D8C5F9C5-C991-4234-909B-761120610ABC', 'name': 'enroll.emba.kellogg.admin', 'remark': '【EMBA招生】凯洛格管理员权限'}, {'id': 'DB60EC07-80CA-42CC-A91E-9AA746A07F41', 'name': 'Global-Affairs.admin', 'remark': '【全球事务办公室】的管理员权限'}, {'id': 'E48FBED2-4F5F-4871-B7AE-F64B9893BD51', 'name': 'alumni.search.admin', 'remark': '【查校友】的管理员权限'}, {'id': 'E4F3081F-88D0-47E7-9CD1-7D9E2A54291B', 'name': 'enroll.undergraduate.admin', 'remark': '【MBA本科研究生】的管理员权限'}, {'id': 'E7B5A7A7-B046-4126-8E81-04BF48D2F1A2', 'name': 'enroll.exed.adminproject.gk', 'remark': '【Exed公开课】项目管理权限'}, {'id': 'EA590D62-302F-4063-BCE5-8C1C0B9CADE1', 'name': 'enroll.emba.hku.admin', 'remark': '【EMBA招生】港大管理员权限'}, {'id': 'EB427AC7-5E15-49EC-8DA7-B279D3DA3C08', 'name': 'enroll.mba.overseas.admin', 'remark': '【MBA海外招生】的管理员权限'}, {'id': 'F88CDF3B-FD56-4ADF-8F7C-E9F039DDF35A', 'name': 'enroll.exed.admin', 'remark': '【ExEd销售统筹】的权限'}, {'id': 'F88CDF3B-FD56-4ADF-8F7C-E9F039DDF77A', 'name': 'enroll.dba.admin', 'remark': '【DBA招生】的管理员权限'}, {'id': 'F88CDF3B-FD56-4ADF-8F7C-E9F039DDF80A', 'name': 'hr.staff.admin', 'remark': '【人力资源教职员】管理员权限'}, {'id': 'F88CDF3B-FD56-4ADF-8F7C-E9F039DDF81A', 'name': 'education.benyan.admin', 'remark': '【本研教务】管理员'}, {'id': 'F88CDF3B-FD56-4ADF-8F7C-E9F039DDF82A', 'name': 'education.mba.admin', 'remark': '【MBA教务】管理员'}, {'id': 'F88CDF3B-FD56-4ADF-8F7C-E9F039DDF83A', 'name': 'education.emba.admin', 'remark': '【EMBA教务】管理员'}, {'id': 'FFDF88EE-BD7A-4297-B32E-D5B1E6E3D6F2', 'name': 'SMS.Admin', 'remark': '【短信数据管理员】'}, {'id': 'FFDF88EE-BD7A-4297-B32E-D5B1E6E3D6F3', 'name': 'SMS.user', 'remark': '【短信发送】用户'}, {'id': 'FFDF88EE-BD7A-4297-B32E-D5B1E6E3D6F6', 'name': 'questionnaire.emba', 'remark': '问卷-EMBA教务'}, {'id': 'FFDF88EE-BD7A-4297-B32E-D5B1E6E3D6F8', 'name': 'questionnaire.cdc', 'remark': '问卷-职发'}, {'id': 'FFDF88EE-BD7A-4297-B32E-D5B1E6E4D6F9', 'name': 'mail.user', 'remark': '邮件群发用户'}], 'depInfo': [{'departmentId': '4', 'departmentName': 'EMBA中心', 'positionID': '894', 'positionName': '2', 'positionLevel': '2'}, {'departmentId': '4', 'departmentName': 'EMBA中心', 'positionID': '895', 'positionName': '3', 'positionLevel': '0'}, {'departmentId': '5', 'departmentName': 'ExEd中心', 'positionID': '893', 'positionName': '1', 'positionLevel': '0'}], 'hrff': '661E8E32918DA670B47F1A72112D258C8791AEC8839D0579AAC6C9B3FDCDAD40', 'hash': '6C397A6F5CC25501', 'moblie': '13461399373', 'workTel': '86-10-62754817', 'hrUserId': 29, 'hrCname': '王野', 'isExternalUsers': False, 'staffType': '1'}, 'statusCode': 200, 'message': '请求(或处理)成功', 'timestamp': '1659669942'}}"}, {"name": "get_dev_sql_server", "value": "<pymssql._pymssql.Cursor object at 0x000001E861AB5D80>"}], "start": 1659669955304, "stop": 1659669955576}], "attachments": [{"name": "log", "source": "218f6e07-24b9-4339-a145-0bff20414585-attachment.txt", "type": "text/plain"}], "start": 1659669955303, "stop": 1659669955596, "uuid": "c332406d-e6a6-47a0-ba22-05ad3987875f", "historyId": "e5e0012801cc505955d3061912aeedbf", "testCaseId": "d36833699870dfd6a8e500b924592237", "fullName": "ApiTestCase.test_JYZZ_ApiTest.TestCase#test_query_paper_weight", "labels": [{"name": "severity", "value": "critical"}, {"name": "feature", "value": "JYZZ_query_paper_weight"}, {"name": "story", "value": "JYZZ_query_paper_weight"}, {"name": "tag", "value": "@pytest.mark.usefixtures('get_JYZZ_param', 'get_dev_sql_server')"}, {"name": "parentSuite", "value": "ApiTestCase"}, {"name": "suite", "value": "test_JYZZ_ApiTest"}, {"name": "subSuite", "value": "TestCase"}, {"name": "host", "value": "DESKTOP-6F6M3JK"}, {"name": "thread", "value": "13432-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "ApiTestCase.test_JYZZ_ApiTest"}]}